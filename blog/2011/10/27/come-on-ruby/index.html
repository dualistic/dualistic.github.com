
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>I know we can do better, Ruby (a simple setup in 8 excruciating steps) - Dualistic</title>
  <meta name="author" content="Pol Llovet">

  
  <meta name="description" content="I love Ruby, but it can be a total pain in the ass. Not the language, mind you, but the ecosystem.  And the crazy thing is, the Rubygems+RVM setup ...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dualistic.com/blog/2011/10/27/come-on-ruby/">
  <link href="/favicon.png" rel="icon" type="image/png">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Dualistic" type="application/atom+xml">
  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Cardo:400,400italic,700' rel='stylesheet' type='text/css'>
</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dualistic</a></h1>
  
    <h2>Pol Llovet :: Life & Work</h2>
  
</hgroup>
<div id='blossoms'><img src='/images/blossoms.png' alt='plum blossoms'></div>
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dualistic.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">blog</a></li>
  <li><a href="/blog/archives">archive</a></li>
  <li><a href="/projects">projects</a></li>
  <li><a href="/about">about</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">I Know We Can Do Better, Ruby (a Simple Setup in 8 Excruciating Steps)</h1>
    
    
      <p class="meta">
        





  





  <a href="/blog/2011/10/26/soaping-with-ruby-and-php/" title="Previous Post:
  SOAPing With Ruby and PHP">&laquo;</a>


<a href="/blog/2011/12/01/ifcase-what/" title="next Post:
Case what?">&raquo;</a>
<time datetime="2011-10-27T22:05:00-06:00" pubdate  data-updated="true" >Oct 27<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I love Ruby, but it can be a total pain in the ass. Not the language, mind you, but the ecosystem.  And the crazy thing is, the Rubygems+RVM setup is basically unparalleled in the development world for flexibility and ease of use.  I really can&#8217;t think of any other dev environment that is half as cool. So, what&#8217;s wrong?  Well, let&#8217;s go on a little journey&#8230;</p>

<!-- more -->


<h2>A Simple Problem</h2>

<p>As mentioned in a <a href="/blog/2011/10/26/soaping-with-ruby-and-php/">prior post</a>, I am doing some messing around with SOAP.  As it happens, I am moving from my development area to try this in a server machine.  No problem.</p>

<p>Note: I am going to include every hiccup I ran into, even those that aren&#8217;t the fault of the Ruby ecosystem, just to be thorough.  I am just tracing the steps that a complete newb would.</p>

<h3>Step 1: RVM</h3>

<p>This is a fresh, minimal install of Ubuntu, so I go to the RVM site, copy the install command and paste it into my terminal:</p>

<figure class='code'><figcaption><span>install rvm (try 1)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bash &lt; &lt;<span class="o">(</span>curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer <span class="o">)</span>
</span><span class='line'>The program <span class="s1">&#39;curl&#39;</span> is currently not installed.  You can install it by typing:
</span><span class='line'>sudo apt-get install curl
</span></code></pre></td></tr></table></div></figure>


<p><strong>Hitch #1:</strong> Curl isn&#8217;t installed on this machine.<br /> <strong>Solution:</strong> <code>sudo apt-get install curl</code></p>

<p>Next try:</p>

<figure class='code'><figcaption><span>install rvm (try 2)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bash &lt; &lt;<span class="o">(</span>curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer <span class="o">)</span>
</span><span class='line'>bash: line 154: git: <span class="nb">command </span>not found
</span><span class='line'>bash: line 156: git: <span class="nb">command </span>not found
</span><span class='line'>
</span><span class='line'>ERROR: Unable to clone the RVM repository, attempted both git:// and https://
</span></code></pre></td></tr></table></div></figure>


<p><strong>Hitch #2:</strong> Git isn&#8217;t installed on this machine.<br /> <strong>Solution:</strong> <code>sudo apt-get install git-core</code></p>

<p>Note: I did a quick check of the RVM docs, and it doesn&#8217;t seem to mention anywhere that git/curl may not be available and what to do about it if they aren&#8217;t.</p>

<figure class='code'><figcaption><span>install rvm (try 3)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bash &lt; &lt;<span class="o">(</span>curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer <span class="o">)</span>
</span><span class='line'>Initialized empty Git repository in /home/pol/.rvm/src/rvm/.git/
</span><span class='line'>...SNIP...
</span><span class='line'><span class="c"># For JRuby, install the following:</span>
</span><span class='line'>  jruby: /usr/bin/apt-get install curl g++ openjdk-6-jre-headless
</span><span class='line'>  jruby-head: /usr/bin/apt-get install ant openjdk-6-jdk
</span><span class='line'>
</span><span class='line'><span class="c"># For IronRuby, install the following:</span>
</span><span class='line'>  ironruby: /usr/bin/apt-get install curl mono-2.0-devel
</span></code></pre></td></tr></table></div></figure>


<p>Success! this point RVM installs cleanly, and after logging in/out (or <code>source ~/.bashrc</code>), RVM is ready to go.  However, it is of note that the WALL OF TEXT that RVM spits out is exceptionally daunting.  It would be nice if the last thing shown was generally relevant (like, hey, you need to restart your shell), not here&#8217;s what you need for IronRuby.  I know, I know, RTFM, but&#8230; it&#8217;s a thing.</p>

<h3>Step 2: Ruby</h3>

<p>I need ruby 1.9.2, so let&#8217;s grab that.</p>

<figure class='code'><figcaption><span>install ruby 1.9.2</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rvm install ruby-1.9.2-p290
</span><span class='line'>Installing Ruby from <span class="nb">source </span>to: /home/pol/.rvm/rubies/ruby-1.9.2-p290, this may take a <span class="k">while </span>depending on your cpu<span class="o">(</span>s<span class="o">)</span>...
</span><span class='line'>
</span><span class='line'>ruby-1.9.2-p290 - <span class="c">#fetching </span>
</span><span class='line'>ruby-1.9.2-p290 - <span class="c">#downloading ruby-1.9.2-p290, this may take a while depending on your connection...</span>
</span><span class='line'>...SNIP...
</span><span class='line'>Install of ruby-1.9.2-p290 - <span class="c">#complete</span>
</span></code></pre></td></tr></table></div></figure>


<p>Great! Mission accomplished, everything built cleanly.</p>

<h3>Step 3: Create a Gemset</h3>

<p>Gemsets are good practice, so let&#8217;s make one:</p>

<figure class='code'><figcaption><span>create and use a gemset</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rvm gemset create webofscience
</span><span class='line'><span class="s1">&#39;webofscience&#39;</span> gemset created <span class="o">(</span>/home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience<span class="o">)</span>.
</span><span class='line'><span class="nv">$ </span>rvm gemset use webofscience
</span><span class='line'>Using /home/pol/.rvm/gems/ruby-1.9.2-p290 with gemset webofscience
</span></code></pre></td></tr></table></div></figure>


<p>Awesome.  Again, everything going smoothly (yay we &lt;3 ruby!) It&#8217;s worth mentioning here that at this point I am getting warm and fuzzy feelings about Ruby+RVM.  This is how it <em>should be</em>.</p>

<h3>Step 4: Install the Gems (try 1)</h3>

<p>Last step before pulling out the editor, get the gems:</p>

<figure class='code'><figcaption><span>install the gems</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gem install savon handsoap
</span><span class='line'>ERROR:  Loading <span class="nb">command</span>: install <span class="o">(</span>LoadError<span class="o">)</span>
</span><span class='line'>    no such file to load -- zlib
</span><span class='line'>ERROR:  While executing gem ... <span class="o">(</span>NameError<span class="o">)</span>
</span><span class='line'>    uninitialized constant Gem::Commands::InstallCommand
</span></code></pre></td></tr></table></div></figure>


<p>Wait, WTF?  There haven&#8217;t been any errors or anything, what is this?</p>

<p><strong>Hitch #3:</strong> Mysterious &#8220;no such file to load &#8211; zlib&#8221; ERROR.<br /> <strong>Solution:</strong> At this point the user will need to google.  If they have good google-fu, they will find the stack-overflow solution (there are other ways to solve this, but the rvm one is the cleanest).</p>

<h3>Step 5: Remove Ruby, add zlib, redo steps 2 &amp; 3</h3>

<p>Ok, so, a minor hitch, just add a lib, change the rvm ruby install command a bit, and get caught up again.</p>

<figure class='code'><figcaption><span>remove ruby, add zlib, and recompile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rvm gemset delete webofscience
</span><span class='line'>WARN: Are you SURE you wish to remove the entire gemset directory <span class="s1">&#39;webofscience&#39;</span> <span class="o">(</span>/home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience<span class="o">)</span>?
</span><span class='line'><span class="o">(</span>anything other than <span class="s1">&#39;yes&#39;</span> will cancel<span class="o">)</span> &gt; yes
</span><span class='line'><span class="nv">$ </span>rvm remove ruby-1.9.2-p290
</span><span class='line'>Removing /home/pol/.rvm/src/ruby-1.9.2-p290...
</span><span class='line'>Removing /home/pol/.rvm/rubies/ruby-1.9.2-p290...
</span><span class='line'>Removing ruby-1.9.2-p290 aliases...
</span><span class='line'>Removing ruby-1.9.2-p290 wrappers...
</span><span class='line'>Removing ruby-1.9.2-p290 environments...
</span><span class='line'>Removing ruby-1.9.2-p290 binaries...
</span><span class='line'><span class="nv">$ </span>rvm pkg install zlib
</span><span class='line'>Fetching zlib-1.2.5.tar.gz to /home/pol/.rvm/archives
</span><span class='line'>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span><span class='line'>                                 Dload  Upload   Total   Spent    Left  Speed
</span><span class='line'>100  531k  100  531k    0     0   318k      0  0:00:01  0:00:01 --:--:--  371k
</span><span class='line'>Extracting zlib-1.2.5.tar.gz to /home/pol/.rvm/src
</span><span class='line'>Configuring zlib in /home/pol/.rvm/src/zlib-1.2.5.
</span><span class='line'>Compiling zlib in /home/pol/.rvm/src/zlib-1.2.5.
</span><span class='line'>Installing zlib to /home/pol/.rvm/usr
</span><span class='line'><span class="nv">$ </span>rvm install 1.9.2-p290 -C --with-zlib-dir<span class="o">=</span><span class="nv">$rvm_path</span>/usr
</span><span class='line'>Installing Ruby from <span class="nb">source </span>to: /home/pol/.rvm/rubies/ruby-1.9.2-p290, this may take a <span class="k">while </span>depending on your cpu<span class="o">(</span>s<span class="o">)</span>...
</span><span class='line'>...SNIP...
</span><span class='line'>Install of ruby-1.9.2-p290 - <span class="c">#complete</span>
</span><span class='line'><span class="nv">$ </span>rvm use ruby-1.9.2-p290
</span><span class='line'>Using /home/pol/.rvm/gems/ruby-1.9.2-p290
</span><span class='line'><span class="nv">$ </span>rvm gemset create webofscience
</span><span class='line'><span class="s1">&#39;webofscience&#39;</span> gemset created <span class="o">(</span>/home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience<span class="o">)</span>.
</span><span class='line'><span class="nv">$ </span>rvm use ruby-1.9.2-p290@webofscience
</span><span class='line'>Using /home/pol/.rvm/gems/ruby-1.9.2-p290 with gemset webofscience
</span></code></pre></td></tr></table></div></figure>


<p>Rockin.  Minor misstep, let&#8217;s keep on rollin&#8217;.</p>

<h3>Step 6: Install the Gems (try 2)</h3>

<p>Second time&#8217;s the charm!  You&#8217;d think&#8230;</p>

<figure class='code'><figcaption><span>install the gems (try 2)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gem install savon handsoap
</span><span class='line'>Fetching: builder-3.0.0.gem <span class="o">(</span>100%<span class="o">)</span>
</span><span class='line'>Fetching: nori-1.0.2.gem <span class="o">(</span>100%<span class="o">)</span>
</span><span class='line'>Fetching: rack-1.3.5.gem <span class="o">(</span>100%<span class="o">)</span>
</span><span class='line'>Fetching: httpi-0.9.5.gem <span class="o">(</span>100%<span class="o">)</span>
</span><span class='line'>Fetching: nokogiri-1.5.0.gem <span class="o">(</span>100%<span class="o">)</span>
</span><span class='line'>Building native extensions.  This could take a <span class="k">while</span>...
</span><span class='line'>ERROR:  Error installing savon:
</span><span class='line'>  ERROR: Failed to build gem native extension.
</span><span class='line'>
</span><span class='line'>        /home/pol/.rvm/rubies/ruby-1.9.2-p290/bin/ruby extconf.rb
</span><span class='line'>checking <span class="k">for </span>libxml/parser.h... no
</span><span class='line'>-----
</span><span class='line'>libxml2 is missing.  please visit http://nokogiri.org/tutorials/installing_nokogiri.html <span class="k">for </span><span class="nb">help </span>with installing dependencies.
</span><span class='line'>-----
</span><span class='line'>*** extconf.rb failed ***
</span><span class='line'>...SNIP...
</span><span class='line'>Successfully installed handsoap-1.1.8
</span><span class='line'>1 gem installed
</span><span class='line'>Installing ri documentation <span class="k">for </span>handsoap-1.1.8...
</span><span class='line'>Installing RDoc documentation <span class="k">for </span>handsoap-1.1.8...
</span></code></pre></td></tr></table></div></figure>


<p>Ok, missing libxml2.  Again, would have been nice to know this earlier&#8230; but this is more like the git/curl situation, it&#8217;s an OS thing.</p>

<p><strong>Hitch #4:</strong> Nokogiri gem has a compilation error.<br /> <strong>Solution:</strong> After googling around, the nokogiri docs say that on ubuntu, you need a couple more libs: <code>sudo apt-get install libxslt-dev libxml2-dev</code></p>

<p>After installing the libs, the gems finally install cleanly:</p>

<figure class='code'><figcaption><span>install the gems (try 3)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gem install savon handsoap
</span><span class='line'>Building native extensions.  This could take a <span class="k">while</span>...
</span><span class='line'>Fetching: wasabi-2.0.0.gem <span class="o">(</span>100%<span class="o">)</span>
</span><span class='line'>Fetching: gyoku-0.4.4.gem <span class="o">(</span>100%<span class="o">)</span>
</span><span class='line'>...SNIP...
</span><span class='line'>Installing RDoc documentation <span class="k">for </span>savon-0.9.7...
</span><span class='line'>Installing RDoc documentation <span class="k">for </span>handsoap-1.1.8...
</span></code></pre></td></tr></table></div></figure>


<p>Great!  Gems are installed, everything is ready to rock n&#8217; roll.</p>

<h3>Step 7: Run the code</h3>

<p>So, the code is super trivial (<a href="https://gist.github.com/1321660">gist</a> if you want to see), let&#8217;s run it:</p>

<figure class='code'><figcaption><span>run the code!</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>ruby wos.rb
</span><span class='line'>/home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in <span class="sb">`</span>require<span class="s1">&#39;: no such file to load -- openssl (LoadError)</span>
</span><span class='line'><span class="s1"> from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require&#39;</span>
</span><span class='line'>  from /home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience/gems/httpi-0.9.5/lib/httpi/auth/ssl.rb:1:in <span class="sb">`</span>&lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require&#39;</span>
</span><span class='line'>  from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in <span class="sb">`</span>require<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> from /home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience/gems/httpi-0.9.5/lib/httpi/auth/config.rb:1:in `&lt;top (required)&gt;&#39;</span>
</span><span class='line'>  from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in <span class="sb">`</span>require<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require&#39;</span>
</span><span class='line'>  from /home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience/gems/httpi-0.9.5/lib/httpi/request.rb:2:in <span class="sb">`</span>&lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require&#39;</span>
</span><span class='line'>  from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in <span class="sb">`</span>require<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> from /home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience/gems/savon-0.9.7/lib/savon/client.rb:1:in `&lt;top (required)&gt;&#39;</span>
</span><span class='line'>  from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in <span class="sb">`</span>require<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> from /home/pol/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require&#39;</span>
</span><span class='line'>  from /home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience/gems/savon-0.9.7/lib/savon.rb:3:in <span class="sb">`</span>&lt;top <span class="o">(</span>required<span class="o">)</span>&gt;<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> from &lt;internal:lib/rubygems/custom_require&gt;:33:in `require&#39;</span>
</span><span class='line'>  from &lt;internal:lib/rubygems/custom_require&gt;:33:in <span class="sb">`</span>rescue in require<span class="s1">&#39;</span>
</span><span class='line'><span class="s1"> from &lt;internal:lib/rubygems/custom_require&gt;:29:in `require&#39;</span>
</span><span class='line'>  from wos.rb:1:in <span class="sb">`</span>&lt;main&gt;<span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Can I get another WTF?  Everything installed clean!  Ruby, RVM, Gems, everything&#8230; why is this breaking?</p>

<p><strong>Hitch #5:</strong> Running the code throws a &#8220;no such file to load &#8211; openssl&#8221; error.<br /> <strong>Solution:</strong> Google again to the rescue; more specifically stack-overflow to the rescue.  This solution is similar to the first: use rvm to add the missing libs to ruby. Awesome, we get to re-compile again.</p>

<h3>Step 8: Remove Ruby, add openssl and iconv, redo steps 2, 3, 6 &amp; 7</h3>

<p>We&#8217;ve had some practice, so let&#8217;s do it again, though the stack-overflow said to install iconv in addition to openssl.  Since we won&#8217;t get <em>any</em> information in advance as to whether or not iconv is required, let&#8217;s just do it now.  Also, don&#8217;t forget the original zlib compilation that we did!</p>

<figure class='code'><figcaption><span>remove ruby, add openssl, and recompile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rvm gemset delete webofscience
</span><span class='line'>WARN: Are you SURE you wish to remove the entire gemset directory <span class="s1">&#39;webofscience&#39;</span> <span class="o">(</span>/home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience<span class="o">)</span>?
</span><span class='line'><span class="o">(</span>anything other than <span class="s1">&#39;yes&#39;</span> will cancel<span class="o">)</span> &gt; yes
</span><span class='line'><span class="nv">$ </span>rvm remove ruby-1.9.2-p290
</span><span class='line'>Removing /home/pol/.rvm/src/ruby-1.9.2-p290...
</span><span class='line'>Removing /home/pol/.rvm/rubies/ruby-1.9.2-p290...
</span><span class='line'>Removing ruby-1.9.2-p290 aliases...
</span><span class='line'>Removing ruby-1.9.2-p290 wrappers...
</span><span class='line'>Removing ruby-1.9.2-p290 environments...
</span><span class='line'>Removing ruby-1.9.2-p290 binaries...
</span><span class='line'><span class="nv">$ </span>rvm pkg install openssl
</span><span class='line'>Fetching openssl-0.9.8n.tar.gz to /home/pol/.rvm/archives
</span><span class='line'>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span><span class='line'>                                 Dload  Upload   Total   Spent    Left  Speed
</span><span class='line'>100 3681k  100 3681k    0     0   560k      0  0:00:06  0:00:06 --:--:--  704k
</span><span class='line'>Extracting openssl-0.9.8n.tar.gz to /home/pol/.rvm/src
</span><span class='line'>Configuring openssl in /home/pol/.rvm/src/openssl-0.9.8n.
</span><span class='line'>Compiling openssl in /home/pol/.rvm/src/openssl-0.9.8n.
</span><span class='line'>Installing openssl to /home/pol/.rvm/usr
</span><span class='line'><span class="nv">$ </span>rvm install 1.9.2 -C --with-openssl-dir<span class="o">=</span><span class="nv">$rvm_path</span>/.rvm/usr,--with-iconv-dir<span class="o">=</span><span class="nv">$rvm_path</span>/usr,--with-zlib-dir<span class="o">=</span><span class="nv">$rvm_path</span>/usr
</span><span class='line'>Installing Ruby from <span class="nb">source </span>to: /home/pol/.rvm/rubies/ruby-1.9.2-p290, this may take a <span class="k">while </span>depending on your cpu<span class="o">(</span>s<span class="o">)</span>...
</span><span class='line'>...SNIP...
</span><span class='line'>Install of ruby-1.9.2-p290 - <span class="c">#complete</span>
</span><span class='line'><span class="nv">$ </span>rvm use ruby-1.9.2-p290
</span><span class='line'>Using /home/pol/.rvm/gems/ruby-1.9.2-p290
</span><span class='line'><span class="nv">$ </span>rvm gemset create webofscience
</span><span class='line'><span class="s1">&#39;webofscience&#39;</span> gemset created <span class="o">(</span>/home/pol/.rvm/gems/ruby-1.9.2-p290@webofscience<span class="o">)</span>.
</span><span class='line'><span class="nv">$ </span>rvm use ruby-1.9.2-p290@webofscience
</span><span class='line'>Using /home/pol/.rvm/gems/ruby-1.9.2-p290 with gemset webofscience
</span><span class='line'><span class="nv">$ </span>gem install savon handsoap
</span><span class='line'>Fetching: builder-3.0.0.gem <span class="o">(</span>100%<span class="o">)</span>
</span><span class='line'>...SNIP...
</span><span class='line'>Installing RDoc documentation <span class="k">for </span>savon-0.9.7...
</span><span class='line'>Installing RDoc documentation <span class="k">for </span>handsoap-1.1.8...
</span><span class='line'><span class="nv">$ </span>ruby wos.rb
</span><span class='line'>D, <span class="o">[</span>2011-10-27T23:30:14.123847 <span class="c">#23626] DEBUG -- : HTTPI executes HTTP GET using the net_http adapter</span>
</span><span class='line'>...
</span></code></pre></td></tr></table></div></figure>


<p>And finally, it all works.</p>

<h2>Summary of Issues</h2>

<ol>
<li>(minor) RVM doesn&#8217;t tell you which packages you need in order to use their install scripts</li>
<li>RVM doesn&#8217;t check for required libs necessary to run rubygems, so everything will compile, but you may still have a nonfunctional system.</li>
<li>RVM also doesn&#8217;t let you know which optional libs might be needed by various ruby gems, and the gems don&#8217;t tell you if it is just a system lib you are missing, or something that needs to be compiled into Ruby.</li>
<li>Gems that require additional compiled ruby functionality don&#8217;t check to see if it is available when the gem is installed, it just fails at runtime.</li>
</ol>


<p>The upshot is that while this is annoying for an experienced user, it could represent a brick wall for a new user.  This should be a straightforward and easy process. And I get the feeling that if I had removed the RVM variable, it would have made the problem even harder to solve because recompiling is harder when you have installed from apt.</p>

<p>I love ruby, but this is kind of embarrassing.  What can we do to make this better?</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Pol Llovet</span></span>

      





  





  <a href="/blog/2011/10/26/soaping-with-ruby-and-php/" title="Previous Post:
  SOAPing With Ruby and PHP">&laquo;</a>


<a href="/blog/2011/12/01/ifcase-what/" title="next Post:
Case what?">&raquo;</a>
<time datetime="2011-10-27T22:05:00-06:00" pubdate  data-updated="true" >Oct 27<span>th</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/pita/'>pita</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>, <a class='category' href='/blog/categories/rvm/'>rvm</a>, <a class='category' href='/blog/categories/soap/'>soap</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://dualistic.com/blog/2011/10/27/come-on-ruby/" data-via="_pol" data-counturl="http://dualistic.com/blog/2011/10/27/come-on-ruby/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
</div>

    
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/03/02/print-out-datamapper-query/">Print out DataMapper Query</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/12/01/ifcase-what/">Case what?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/10/27/come-on-ruby/">I know we can do better, Ruby (a simple setup in 8 excruciating steps)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/10/26/soaping-with-ruby-and-php/">SOAPing With Ruby and PHP</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/10/26/there-has-never-been-a-better-time-to-be-a-self-taught-coder/">There Has Never Been a Better Time to Be a Self-taught Coder</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("_pol", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/_pol" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @_pol</a>
  
</section>


<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/pol">@pol</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'pol',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  <a href='http://creativecommons.org/licenses/by-nc-sa/3.0/'>CC BY-NC-SA 3.0</a> - Pol Llovet -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
    (function () {
      var disqus_shortname = 'dualistic';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://dualistic.com/blog/2011/10/27/come-on-ruby/';
        var disqus_url = 'http://dualistic.com/blog/2011/10/27/come-on-ruby/';
        var disqus_script = 'embed.js'
      

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







</body>
</html>
